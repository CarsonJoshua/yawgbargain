{% extends 'base.html' %}

{% block title %}{{ card.name }} Price History{% endblock %}

{% block content %}
<div style="padding: 20px;">
    <h1>{{ card.name }} Price History</h1>
    
    <!-- Canvas element for the chart -->
    <canvas id="priceChart" width="400" height="200"></canvas>

    <script>
        // Get the price data from Flask
        const priceData = {{price_data|tojson}};    
        
        // Extract the dates and prices into separate arrays
        const dates = priceData.map(item => item.date);
        const prices = priceData.map(item => item.price);

        // Set up the Chart.js chart
        const ctx = document.getElementById('priceChart').getContext('2d');
        const priceChart = new Chart(ctx, {
            type: 'line', // Line chart for price history
            data: {
                labels: dates, // X-axis: Dates
                datasets: [{
                    label: 'Price',
                    data: prices, // Y-axis: Prices
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1,
                    fill: false
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        type: 'category',
                        title: {
                            display: true,
                            text: 'Date'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Price'
                        },
                        ticks: {
                            beginAtZero: false
                        }
                    }
                }
            }
        });
    </script>
</div>
{% endblock %}
